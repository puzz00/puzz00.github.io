<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./pts.css">
    <title>system and host attacks windows hashes</title>
</head>
<body>
    <header class="navbar">
        <a href="https://github.com/puzz00" target="_blank"><img src="./images/chess_1.jpg" alt="black or white?"></a>
        <h1>windows hashes</h1>
        <nav class="links">
            <ul>
                <li><a href="./index.html">home</a></li>
                <li><a href="./host_and_network_pen_testing.html">host and network</a></li>
                <li><a href="./system_and_host_attacks.html">system and host attacks</a></li>
                <li><a href="./win_creds.html">win creds</a></li>
                <li><a class="active" href="#">hashes</a></li>
            </ul>
        </nav>
    </header>
    <section class="main-content">
        <h2>Windows Password Hashes</h2>
        <p>
            Windows uses authentication protocols to enable clients and servers to communicate with each other. Kerberos is widely used, but NT Lan Manager (NTLM) is still used. It is used, for example, when a client uses an IP address to authenticate to a server, or a client wants to authenticate to a server which is not a part of the same domain. 
        </p>
        <p>
            Windows uses different forms of NTLM hashes to secure user credentials. When an account is created, the credentials are hashed using the MD4 hashing algorithm.
        </p>
        <p>
            The credentials are stored in a database file which is known as the Security Account Manager (SAM). This file is encrypted with a syskey. It is also locked by the NT kernel whilst the operating system is running. It cannot be copied whilst the os is running.
        </p>
        <p>
            Authentication and verification of users' credentials is undertaken by the Local Security Authority. This uses the LSASS process which interacts with the SAM. Since the LSASS process interacts with the SAM, we can find the SAM hashes in the memory of the LSASS process. In order to do this, elevated privileges are needed. Tools such as mimikatz use the LSASS memory to try to retrieve and dump the hashes from the SAM.
        </p>
        <p>
            NTLM uses three messages to establish authentication. The first message is a negotiation, the second is a challenge and the third is authentication. The first message is the username sent as plaintext. The second message is a challenge which has been generated by the server. The client then hashes the challenge using the hash of the user password and returns this hashed challenge to the server.
        </p>
    </section>
    <section class="extra-info">
        <p class="tagline">
            the enemy knows the system
        </p>
        <div class="contact">
            <p>puzz00</p>
            <a href="https://github.com/puzz00" class="active" target="_blank">knock knock</a>
        </div>
    </section>
</body>
</html>